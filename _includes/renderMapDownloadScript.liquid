{%- comment -%}

This snippet renders the download script for a given map item. Only single quotes are allowed to be used here.

Args:
  map: the collection map item

Renders:
  full map download script

{%- endcomment -%}
{%- include getParent.liquid file_path=include.map.path -%}


{%- capture frbFiles -%}
  {%- if include.map.frbFile4 -%}
      {{ include.map.frbFile1 }},{{include.map.frbFile2}},{{include.map.frbFile3}},{{include.map.frbFile4}}
  {%- elsif include.map.frbFile3 -%}
      {{ include.map.frbFile1 }},{{include.map.frbFile2}},{{include.map.frbFile3}}
  {%- elsif include.map.frbFile2 -%}
      {{ include.map.frbFile1 }},{{include.map.frbFile2}}
  {%- elsif include.map.frbFile1 -%}
      {{ include.map.frbFile1 }}
  {%- else -%}
      {{ include.map.frbFiles| join: ","}}
  {%- endif -%}
{%- endcapture %}

{% assign frbList = frbFiles | split: "," %}
{% assign url_base = "https://raw.githubusercontent.com/FortuneStreetModding/fortunestreetmodding.github.io/main/" %}

saveZip('{{ gd_directory_name }}', [
  {{- url_base | prepend: "'" | append: include.map.path | append: "'" -}}
  {{- url_base | prepend: ",'" | append: gd_directory_path | append: "/" | append: include.map.frbFile1 | append: ".frb'" -}}
  {%- if include.map.frbFile2 -%}
  {{- url_base | prepend: ",'" | append: gd_directory_path | append: "/" | append: include.map.frbFile2 | append: ".frb'" -}}
  {%- endif -%}
  {%- if include.map.frbFile3 -%}
  {{- url_base | prepend: ",'" | append: gd_directory_path | append: "/" | append: include.map.frbFile3 | append: ".frb'" -}}
  {%- endif -%}
  {%- if include.map.frbFile4 -%}
  {{- url_base | prepend: ",'" | append: gd_directory_path | append: "/" | append: include.map.frbFile4 | append: ".frb'" -}}
  {%- endif -%}
  {%- if include.map.mapIcon -%}
  {{- url_base | prepend: ",'" | append: gd_directory_path | append: "/" | append: include.map.mapIcon | append: ".png'" -}}
  {%- endif -%}
  ]);
